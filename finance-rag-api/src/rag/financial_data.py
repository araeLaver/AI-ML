# -*- coding: utf-8 -*-
"""
실제 금융 데이터 모듈

[설계 의도]
- 금감원 공시, 증권사 리포트 스타일의 실제 데이터
- 다양한 문서 유형으로 RAG 성능 검증
- 포트폴리오 시연용 고품질 데이터셋
"""

from typing import List, Dict, Any
from dataclasses import dataclass
from datetime import datetime


@dataclass
class FinancialDocument:
    """금융 문서 데이터 클래스"""
    id: str
    title: str
    content: str
    doc_type: str  # disclosure, report, guide, news
    source: str
    date: str
    metadata: Dict[str, Any]


# 금감원 공시 스타일 문서
DISCLOSURE_DOCUMENTS = [
    FinancialDocument(
        id="disc_001",
        title="삼성전자 2024년 3분기 실적 공시",
        content="""[공시 정보]
회사명: 삼성전자주식회사
공시일자: 2024.10.31
공시유형: 분기보고서

[실적 요약]
- 매출액: 79조 1,000억원 (전년동기대비 +17.2%)
- 영업이익: 9조 1,834억원 (전년동기대비 +274.5%)
- 당기순이익: 7조 2,000억원

[부문별 실적]
1. 반도체(DS) 부문
   - 매출: 29조 2,700억원
   - 영업이익: 3조 8,600억원
   - HBM 수요 증가로 메모리 실적 개선
   - AI 서버용 고부가 제품 비중 확대

2. 디스플레이(SDC) 부문
   - 매출: 7조 9,200억원
   - 영업이익: 1조 300억원
   - 중소형 OLED 패널 수요 강세

3. MX/네트워크 부문
   - 매출: 28조 7,400억원
   - Galaxy 시리즈 판매 호조
   - 폴더블폰 시장 점유율 확대

[전망]
- 4분기 AI 반도체 수요 지속 전망
- HBM3E 양산 본격화
- 온디바이스 AI 전략 가속화

[투자 참고사항]
본 공시는 투자 권유가 아니며, 투자 결정은 투자자 본인의 판단과 책임 하에 이루어져야 합니다.
""",
        doc_type="disclosure",
        source="금융감독원 전자공시시스템",
        date="2024-10-31",
        metadata={"company": "삼성전자", "sector": "IT", "market": "KOSPI"}
    ),
    FinancialDocument(
        id="disc_002",
        title="SK하이닉스 2024년 3분기 실적 공시",
        content="""[공시 정보]
회사명: SK하이닉스 주식회사
공시일자: 2024.10.24
공시유형: 분기보고서

[실적 요약]
- 매출액: 17조 5,731억원 (전년동기대비 +93.8%)
- 영업이익: 7조 300억원 (전년동기대비 흑자전환)
- 당기순이익: 5조 7,532억원

[주요 성과]
1. HBM(고대역폭메모리)
   - HBM 매출 전분기 대비 70% 이상 성장
   - HBM3E 12단 양산 업계 최초 성공
   - 2025년 HBM 공급 대부분 선계약 완료

2. NAND 플래시
   - 고용량 서버 SSD 수요 증가
   - 176단 NAND 생산 비중 확대

3. DDR5
   - 서버용 DDR5 전환 가속화
   - AI 서버향 매출 비중 30% 돌파

[향후 전략]
- AI 메모리 리더십 강화
- HBM4 개발 가속화
- 청주 M15X 팹 증설 추진

[리스크 요인]
- 미중 반도체 규제 불확실성
- 메모리 가격 변동성
- 신규 팹 투자에 따른 감가상각 부담
""",
        doc_type="disclosure",
        source="금융감독원 전자공시시스템",
        date="2024-10-24",
        metadata={"company": "SK하이닉스", "sector": "반도체", "market": "KOSPI"}
    ),
    FinancialDocument(
        id="disc_003",
        title="카카오 2024년 3분기 실적 공시",
        content="""[공시 정보]
회사명: 주식회사 카카오
공시일자: 2024.11.07
공시유형: 분기보고서

[실적 요약]
- 매출액: 2조 48억원 (전년동기대비 +4.9%)
- 영업이익: 1,307억원 (전년동기대비 -13.2%)
- 당기순이익: 892억원

[부문별 실적]
1. 플랫폼 부문
   - 매출: 9,892억원
   - 톡비즈: 5,480억원 (광고+커머스)
   - 포털비즈: 2,112억원
   - 카카오페이 연결 매출 반영

2. 콘텐츠 부문
   - 매출: 1조 156억원
   - 뮤직: 4,100억원 (멜론 구독자 증가)
   - 스토리: 2,800억원
   - 미디어: 3,256억원

[주요 이슈]
- SM엔터 경영권 분쟁 관련 비용 반영
- AI 투자 확대에 따른 비용 증가
- 카카오모빌리티 분할 상장 추진

[AI 전략]
- 카카오브레인 'KARLO 3.0' 출시
- 카카오톡 AI 챗봇 고도화
- B2B AI 솔루션 사업 확대
""",
        doc_type="disclosure",
        source="금융감독원 전자공시시스템",
        date="2024-11-07",
        metadata={"company": "카카오", "sector": "인터넷", "market": "KOSPI"}
    ),
]

# 증권사 리포트 스타일 문서
ANALYST_REPORTS = [
    FinancialDocument(
        id="report_001",
        title="[미래에셋] AI 반도체 산업 전망 2025",
        content="""[리서치 리포트]
작성: 미래에셋증권 리서치센터
애널리스트: 김반도
작성일: 2024.11.15

■ 투자의견: 비중확대
■ 목표 수익률: +25%

[Executive Summary]
2025년 AI 반도체 시장은 전년 대비 35% 성장한 1,200억 달러 규모 전망.
HBM과 AI 가속기가 성장을 주도할 것으로 예상.

[시장 전망]
1. HBM(고대역폭메모리) 시장
   - 2024년: 160억 달러
   - 2025년(E): 250억 달러 (+56% YoY)
   - 2026년(E): 350억 달러

2. AI 가속기 시장
   - NVIDIA H100/H200 공급 부족 지속
   - AMD MI300X 시장 점유율 확대
   - 자체 칩 개발 (구글 TPU, AWS Trainium)

3. 엣지 AI 시장
   - 온디바이스 AI 수요 급증
   - NPU 탑재 스마트폰 비중 확대
   - PC AI 시대 개막

[투자 유망 종목]
1. SK하이닉스 (목표가: 280,000원)
   - HBM 시장 점유율 50% 이상
   - 투자의견: 매수

2. 삼성전자 (목표가: 85,000원)
   - HBM3E 양산으로 격차 축소
   - 투자의견: 매수

3. 한미반도체 (목표가: 180,000원)
   - HBM 본딩 장비 독점
   - 투자의견: 매수

[리스크 요인]
- AI 버블 우려에 따른 밸류에이션 조정
- 미국 대중 수출 규제 강화
- 경기 침체 시 IT 투자 축소

※ 본 리포트는 투자 참고용이며, 투자 손실에 대한 책임은 투자자에게 있습니다.
""",
        doc_type="report",
        source="미래에셋증권",
        date="2024-11-15",
        metadata={"analyst": "김반도", "sector": "반도체", "rating": "비중확대"}
    ),
    FinancialDocument(
        id="report_002",
        title="[한국투자] 2차전지 산업 분석",
        content="""[산업 분석 리포트]
작성: 한국투자증권 리서치센터
애널리스트: 이배터리
작성일: 2024.11.10

■ 산업 투자의견: 중립
■ 핵심 키워드: 수요 둔화, 가격 하락, 구조조정

[시장 현황]
글로벌 전기차 판매 성장률 둔화로 2차전지 업황 조정 국면 진입.
2024년 성장률 25%에서 2025년 15%로 하향 조정.

[수급 전망]
1. 공급 과잉 우려
   - 중국 CATL, BYD 공격적 증설
   - 한국 3사 가동률 60% 수준
   - 2025년까지 공급 과잉 지속 전망

2. 가격 동향
   - 리튬 가격: 톤당 12,000달러 (고점 대비 -80%)
   - 배터리 셀 가격: kWh당 100달러 하회
   - 수익성 악화 불가피

3. 기술 트렌드
   - LFP 배터리 점유율 확대 (중국 중심)
   - 전고체 배터리 상용화 2027년 이후
   - 나트륨이온 배터리 개발 가속

[종목별 투자의견]
1. LG에너지솔루션 (목표가: 380,000원)
   - 북미 시장 IRA 수혜
   - 투자의견: 중립

2. 삼성SDI (목표가: 350,000원)
   - 각형 배터리 BMW 공급
   - 투자의견: 중립

3. 에코프로비엠 (목표가: 180,000원)
   - 양극재 가격 하락 영향
   - 투자의견: 비중축소

[투자 전략]
단기 관망 후 2025년 하반기 저점 매수 기회 모색 권고.
전고체 배터리 기술력 보유 기업 관심 필요.
""",
        doc_type="report",
        source="한국투자증권",
        date="2024-11-10",
        metadata={"analyst": "이배터리", "sector": "2차전지", "rating": "중립"}
    ),
    FinancialDocument(
        id="report_003",
        title="[삼성증권] 배당주 투자 전략 2025",
        content="""[투자전략 리포트]
작성: 삼성증권 투자전략팀
작성일: 2024.11.20

■ 전략 키워드: 고배당, 밸류업, 주주환원

[배당 투자 환경]
금리 인하 사이클 진입으로 배당주 매력도 상승.
밸류업 프로그램으로 주주환원 정책 강화 기대.

[주요 고배당주 분석]
1. 금융주
   ┌─────────────┬────────┬─────────┐
   │ 종목        │ 배당수익률 │ 배당성향  │
   ├─────────────┼────────┼─────────┤
   │ 하나금융지주  │ 7.2%   │ 35%     │
   │ KB금융      │ 6.8%   │ 33%     │
   │ 신한지주    │ 6.5%   │ 32%     │
   │ 우리금융지주  │ 7.5%   │ 36%     │
   └─────────────┴────────┴─────────┘

2. 통신주
   - SK텔레콤: 배당수익률 5.8%, 10년 연속 배당 증가
   - KT: 배당수익률 5.2%, 자사주 소각 병행
   - LG유플러스: 배당수익률 5.0%

3. 유틸리티
   - 한국전력: 적자 전환으로 배당 중단
   - 한국가스공사: 배당수익률 4.5%
   - 지역난방공사: 배당수익률 4.8%

[밸류업 수혜주]
정부 밸류업 프로그램으로 주주환원 확대 예상 기업:
- 현대차: PBR 0.5배, 자사주 매입 확대
- 포스코홀딩스: PBR 0.4배, 배당 확대 공시
- KT&G: 배당수익률 6%, 자사주 소각

[포트폴리오 제안]
배당수익률 5% 이상, 배당성향 30% 이상,
3년 연속 배당 증가 기업 중심 투자 권고.

[리스크]
- 기업 실적 악화 시 배당 축소 가능
- 금리 재상승 시 배당주 매력 감소
""",
        doc_type="report",
        source="삼성증권",
        date="2024-11-20",
        metadata={"analyst": "투자전략팀", "sector": "배당주", "rating": "비중확대"}
    ),
]

# 투자 가이드 문서
INVESTMENT_GUIDES = [
    FinancialDocument(
        id="guide_001",
        title="ETF 투자 완벽 가이드",
        content="""[ETF 투자 가이드]

■ ETF란?
ETF(Exchange Traded Fund)는 특정 지수를 추종하는 펀드를
주식처럼 거래소에서 실시간 매매할 수 있는 상품입니다.

■ ETF의 장점
1. 분산투자: 하나의 ETF로 수십~수백 종목에 분산
2. 저비용: 일반 펀드 대비 운용보수 0.1~0.5% 수준
3. 투명성: 구성종목, 가격 실시간 공개
4. 유동성: 주식처럼 실시간 매매 가능
5. 세금 효율: 매매차익 비과세 (국내주식형)

■ ETF 종류
1. 국내 지수형
   - KODEX 200: KOSPI200 추종
   - TIGER 200: KOSPI200 추종
   - KODEX 코스닥150: 코스닥150 추종

2. 해외 지수형
   - TIGER 미국S&P500: S&P500 추종
   - KODEX 미국나스닥100: 나스닥100 추종
   - TIGER 차이나CSI300: 중국 CSI300 추종

3. 섹터/테마형
   - KODEX 반도체: 반도체 관련주
   - TIGER 2차전지테마: 배터리 관련주
   - KODEX AI반도체핵심장비: AI 장비주

4. 채권형
   - KODEX 국고채10년: 10년 국채
   - TIGER 단기채권: 단기채 투자

5. 레버리지/인버스
   - KODEX 레버리지: KOSPI200 2배
   - KODEX 인버스: KOSPI200 -1배
   ※ 주의: 장기 투자 부적합, 단기 트레이딩용

■ ETF 선택 기준
1. 운용보수 (낮을수록 유리)
2. 거래량 (많을수록 유동성 좋음)
3. 괴리율 (NAV와 시장가격 차이, 낮을수록 좋음)
4. 추적오차 (지수와의 수익률 차이, 낮을수록 좋음)
5. 운용사 (대형 운용사 선호)

■ 초보자 추천 포트폴리오
- KODEX 200 (50%): 국내 대형주
- TIGER 미국S&P500 (30%): 미국 대형주
- KODEX 국고채10년 (20%): 안정성
""",
        doc_type="guide",
        source="금융투자교육원",
        date="2024-11-01",
        metadata={"category": "투자가이드", "level": "초급"}
    ),
    FinancialDocument(
        id="guide_002",
        title="주식 기본적 분석 방법론",
        content="""[기본적 분석 가이드]

■ 기본적 분석이란?
기업의 재무제표, 산업 환경, 경제 상황 등을 분석하여
주식의 내재가치를 산출하고 투자 결정에 활용하는 방법론.

■ 핵심 재무비율

1. 수익성 지표
   ┌─────────┬────────────────────┬────────────┐
   │ 지표     │ 산식               │ 의미        │
   ├─────────┼────────────────────┼────────────┤
   │ ROE     │ 순이익/자기자본     │ 자본 효율성  │
   │ ROA     │ 순이익/총자산       │ 자산 효율성  │
   │ 영업이익률│ 영업이익/매출      │ 본업 수익성  │
   │ 순이익률  │ 순이익/매출        │ 최종 수익성  │
   └─────────┴────────────────────┴────────────┘

2. 밸류에이션 지표
   - PER (주가수익비율): 주가 / 주당순이익
     → 낮을수록 저평가, 업종 평균과 비교
   - PBR (주가순자산비율): 주가 / 주당순자산
     → 1 미만이면 자산가치 대비 저평가
   - PSR (주가매출비율): 시가총액 / 매출액
     → 적자 기업 밸류에이션에 활용
   - EV/EBITDA: 기업가치 / 영업이익+감가상각
     → 기업 인수 시 기준 지표

3. 안정성 지표
   - 부채비율: 부채 / 자기자본 (100% 이하 양호)
   - 유동비율: 유동자산 / 유동부채 (200% 이상 양호)
   - 이자보상배율: 영업이익 / 이자비용 (3배 이상 양호)

■ 실전 분석 프로세스

Step 1: 산업 분석
- 산업 성장률, 경쟁 강도, 진입장벽
- 규제 환경, 기술 변화

Step 2: 기업 경쟁력 분석
- 시장점유율, 브랜드 가치
- 원가 경쟁력, 기술력

Step 3: 재무제표 분석
- 3개년 손익계산서 추세
- 현금흐름 건전성
- 자산 구성 및 부채 구조

Step 4: 밸류에이션
- 적정 PER 산출
- DCF(현금흐름할인) 모델
- 동종업계 비교

Step 5: 투자 결정
- 목표가 설정
- 매수/매도 시점 결정
- 리스크 관리 계획

■ 주의사항
- 과거 실적이 미래를 보장하지 않음
- 재무제표 왜곡 가능성 인지
- 정성적 요소(경영진, 거버넌스) 함께 고려
""",
        doc_type="guide",
        source="한국증권학회",
        date="2024-10-15",
        metadata={"category": "투자가이드", "level": "중급"}
    ),
    FinancialDocument(
        id="guide_003",
        title="금리와 주식시장의 관계",
        content="""[금리-주식 상관관계 분석]

■ 금리란?
금리는 돈의 가격. 한국은행 기준금리가 시장금리의 기준점.
2024년 11월 현재 한국 기준금리: 3.00%

■ 금리가 주식에 미치는 영향

1. 할인율 효과
   주식 가치 = 미래 현금흐름의 현재가치
   → 금리 상승 시 할인율 상승 → 주식 가치 하락
   → 금리 하락 시 할인율 하락 → 주식 가치 상승

2. 기업 비용 효과
   - 금리 상승 → 이자비용 증가 → 순이익 감소
   - 특히 고부채 기업에 부정적
   - 금융주는 예대마진 확대로 수혜

3. 경기 효과
   - 금리 상승 → 소비/투자 위축 → 경기 둔화
   - 금리 하락 → 소비/투자 확대 → 경기 부양

4. 자금 이동 효과
   - 금리 상승 → 예금/채권 매력 증가 → 주식 자금 유출
   - 금리 하락 → 예금 금리 하락 → 주식 자금 유입

■ 섹터별 금리 민감도

고금리 수혜 섹터:
- 은행: 예대마진 확대
- 보험: 운용수익 개선
- 달러 강세 수혜주

고금리 피해 섹터:
- 성장주(IT, 바이오): 할인율 민감
- 부동산/건설: 주택수요 감소
- 고부채 기업: 이자비용 부담

■ 금리 사이클과 투자 전략

1. 금리 인상기
   - 가치주 > 성장주
   - 금융주 비중 확대
   - 고배당주 방어적 포지션

2. 금리 정점
   - 경기 방어주 선호
   - 채권 비중 확대 시점

3. 금리 인하기
   - 성장주 > 가치주
   - IT, 바이오 매수 기회
   - 채권 가격 상승

4. 금리 저점
   - 경기민감주 매수 시점
   - 주식 비중 확대

■ 2025년 전망
- 미국 연준: 2025년 중 금리 인하 사이클
- 한국 한은: 경기 부양 위해 인하 예상
- 주식시장: 금리 인하 기대감으로 상승 전망
""",
        doc_type="guide",
        source="한국은행 금융안정보고서",
        date="2024-11-25",
        metadata={"category": "거시경제", "level": "중급"}
    ),
]

# 금융 뉴스 문서
FINANCIAL_NEWS = [
    FinancialDocument(
        id="news_001",
        title="NVIDIA, 3분기 실적 어닝서프라이즈",
        content="""[해외 뉴스]
날짜: 2024.11.21

NVIDIA가 2024년 3분기 실적을 발표했다.

■ 실적 요약
- 매출: 351억 달러 (예상 331억 달러, 상회)
- 순이익: 193억 달러 (전년동기대비 +109%)
- EPS: 0.81달러 (예상 0.75달러, 상회)

■ 부문별 실적
- 데이터센터: 308억 달러 (+112% YoY)
- 게이밍: 33억 달러 (+15% YoY)
- 자동차: 4.5억 달러 (+72% YoY)

■ CEO 코멘트
젠슨 황 CEO는 "AI 혁명은 이제 시작 단계에 불과하며,
Blackwell 아키텍처에 대한 수요가 예상을 초과하고 있다"고 밝혔다.

■ 가이던스
4분기 매출 가이던스 375억 달러 제시.
시장 예상 370억 달러 상회.

■ 시장 반응
- 시간외 거래: +2.5%
- 필라델피아 반도체지수: +1.8%
- 한국 반도체주: 동반 강세 예상

■ 전문가 시각
"NVIDIA의 실적은 AI 인프라 투자가 여전히 강하다는 신호.
HBM 공급사인 SK하이닉스, 삼성전자에 긍정적 영향 전망."
- 모건스탠리 반도체 애널리스트
""",
        doc_type="news",
        source="Reuters",
        date="2024-11-21",
        metadata={"category": "해외증시", "company": "NVIDIA"}
    ),
    FinancialDocument(
        id="news_002",
        title="한국은행 금리 동결, 11월 금통위",
        content="""[국내 뉴스]
날짜: 2024.11.28

한국은행이 11월 금융통화위원회에서 기준금리를
연 3.00%로 동결했다.

■ 결정 배경
- 내수 경기 부진에도 물가 안정 우선
- 미국 연준 금리 동향 관망
- 원/달러 환율 1,400원대 안정 필요

■ 한은 총재 기자회견 요지
"물가 상승률이 2%대로 안정되고 있으나,
환율 변동성과 지정학적 리스크를 감안해
신중한 통화정책 기조를 유지할 것"

■ 시장 금리 반응
- 국고채 3년: 2.95% (전일비 -3bp)
- 국고채 10년: 3.10% (전일비 -5bp)
- 원/달러: 1,395원 (전일비 +5원)

■ 금리 인하 전망
"12월 또는 2025년 1분기 금리 인하 가능성 높음.
경기 부양 필요성이 점점 커지고 있음."
- 한국금융연구원

■ 투자 시사점
- 은행주: 예대마진 축소 우려로 약세
- 성장주: 금리 인하 기대로 반등
- 채권: 금리 하락으로 채권 가격 상승
""",
        doc_type="news",
        source="연합뉴스",
        date="2024-11-28",
        metadata={"category": "금융정책", "keyword": "금리"}
    ),
]


def get_all_documents() -> List[FinancialDocument]:
    """모든 금융 문서 반환"""
    return DISCLOSURE_DOCUMENTS + ANALYST_REPORTS + INVESTMENT_GUIDES + FINANCIAL_NEWS


def get_documents_by_type(doc_type: str) -> List[FinancialDocument]:
    """문서 유형별 필터링"""
    all_docs = get_all_documents()
    return [doc for doc in all_docs if doc.doc_type == doc_type]


def get_document_stats() -> Dict[str, Any]:
    """문서 통계"""
    all_docs = get_all_documents()
    return {
        "total_documents": len(all_docs),
        "by_type": {
            "disclosure": len([d for d in all_docs if d.doc_type == "disclosure"]),
            "report": len([d for d in all_docs if d.doc_type == "report"]),
            "guide": len([d for d in all_docs if d.doc_type == "guide"]),
            "news": len([d for d in all_docs if d.doc_type == "news"]),
        },
        "total_characters": sum(len(d.content) for d in all_docs),
        "sources": list(set(d.source for d in all_docs))
    }
